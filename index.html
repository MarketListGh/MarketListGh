<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MarketList — Home</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
* { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }

/* Preloader overlay */
#preloader {
  position: fixed; top:0; left:0; width:100%; height:100%;
  background:#fff; display:flex; justify-content:center; align-items:center; z-index:9999;
  flex-direction: column;
  transition: opacity 0.5s ease;
}
#preloader.hidden { opacity:0; pointer-events:none; }
.loader-ring { width: 120px; height: 120px; position: relative; display: flex; justify-content: center; align-items: center; }
.loader-ring .ring { width: 120px; height: 120px; border: 6px solid #ccc; border-top-color: #00a859; border-radius: 50%; animation: spin 1s linear infinite; position: absolute; top:0; left:0; }
.loader-ring img { width:60px; height:60px; border-radius:50%; position: relative; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

.splash-text { text-align:center; margin-top:20px; font-size:20px; font-weight:bold; color:#00a859; }
.splash-subtext { text-align:center; margin-top:5px; font-size:16px; color:#333; }

/* Header and Menu */
.headerbar { background:#00a859; color:#fff; padding:10px 20px; }
.headerbar .inner { display:flex; align-items:center; justify-content: space-between; }
.headerbar .brand { display:flex; align-items:center; cursor:pointer; }
.headerbar .brand img { width:40px; margin-right:10px; }
.headerbar .brand .title { font-size:20px; font-weight:normal; color:#fff; }
.headerbar nav a { color:#fff; margin-left:20px; text-decoration:none; font-weight:bold; font-size:13.5px; }
.headerbar nav a:hover { opacity:0.9; text-decoration:none; }

/* Slider */
.slider-box { position:relative; max-width:100%; overflow:hidden; margin-top:20px; }
.slider { display:flex; transition: transform 0.5s ease; }
.slide { min-width:100%; }
.slide img { width:100%; display:block; border-radius:12px; }
.slider-nav { position:absolute; bottom:10px; left:50%; transform:translateX(-50%); display:flex; gap:5px; }
.slider-dot { width:10px; height:10px; background:#ccc; border-radius:50%; cursor:pointer; }
.slider-dot.active { background:#00a859; }
.slider-arrow { position:absolute; top:50%; transform:translateY(-50%); font-size:24px; color:#00a859; background:#fff; border-radius:50%; padding:5px; cursor:pointer; }
.slider-arrow.left { left:10px; }
.slider-arrow.right { right:10px; }

/* Main content */
main.container { max-width:700px; margin:40px auto; padding:20px; }
.card { background: linear-gradient(135deg, #00a859, #ff8c00); color:#fff; padding:30px; border-radius:20px; box-shadow:0 4px 15px rgba(0,0,0,0.2); }
.header-main { display:flex; align-items:center; margin-bottom:20px; }
.header-main img { width:60px; margin-right:15px; }
.header-main h1 { margin:0; }
.slogan { font-style: normal; font-size:0.9em; }

form label { display:block; margin-top:15px; font-weight:bold; }
form input, form select, form textarea { width:100%; padding:10px; margin-top:5px; border:none; border-radius:8px; font-size:15px; }
textarea { height:80px; resize:vertical; }

.row { display:flex; gap:10px; }
.row .col { flex:1; }

.transparent-box { background: rgba(255,255,255,0.95); color:#000; padding:20px; border-radius:12px; margin-top:15px; font-weight:bold; box-shadow: 0 4px 15px rgba(0,0,0,0.25); }

/* WhatsApp button */
.send-whatsapp { display:block; width:100%; text-align:center; background-color:#25D366; color:white; font-weight:bold; padding:15px; margin-top:25px; border-radius:30px; text-decoration:none; transition: background-color 0.3s ease; }
.send-whatsapp:hover { background-color:#1ebe5b; }

footer.footer { text-align:center; padding:15px; background:#eee; margin-top:40px; }

/* Popup map */
#mapPopup { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:1000; }
#mapContainer { width:90%; max-width:500px; height:450px; background:#fff; border-radius:10px; padding:15px; position:relative; display:flex; flex-direction:column; }
#map { flex:1; width:100%; border-radius:10px; position:relative; }
#userMarker { position:absolute; width:20px; height:20px; background:red; border-radius:50%; transform:translate(-50%,-50%); display:none; z-index:1000; }
#closePopup { position:absolute; top:10px; right:15px; background:red; color:#fff; width:25px; height:25px; border:none; border-radius:50%; cursor:pointer; }
#popupButtons { margin-top:10px; display:flex; gap:10px; }
#popupButtons button { flex:1; background:#00a859; color:#fff; font-weight:bold; cursor:pointer; }

/* Chatbot */
.chatbot-btn { position: fixed; bottom: 25px; right: 25px; width: 60px; height: 60px; background: #00a859; color: #fff; border-radius: 50%; box-shadow: 0 4px 15px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; animation: bounce 2s infinite; z-index: 10000; }
@keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-12px); } 60% { transform: translateY(-6px); } }
.chat-overlay { display: none; position: fixed; bottom: 100px; right: 30px; width: 320px; height: 400px; background: rgba(255,255,255,0.95); border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); z-index: 10001; flex-direction: column; overflow: hidden; }
.chat-header { background: #00a859; color: #fff; padding: 10px; text-align: center; font-weight: bold; }
.chat-body { flex: 1; padding: 10px; overflow-y: auto; font-size: 14px; color: #333; display: flex; flex-direction: column; gap: 8px; }
.chat-message { padding: 8px 10px; border-radius: 10px; max-width: 80%; word-wrap: break-word; font-size: 14px; }
.user-msg { background: #f2f2f2; color: #000; align-self: flex-end; }
.bot-msg { background: #d8ecff; color: #000; align-self: flex-start; }

/* Detect location input button container */
#locationContainer { display:flex; gap:10px; margin-top:5px; }
#detectLocationBtn { background:#00a859; color:#fff; font-weight:bold; border:none; border-radius:8px; padding:10px 15px; cursor:pointer; }
</style>
</head>
<body>

<!-- Preloader -->
<div id="preloader">
  <div class="loader-ring"><div class="ring"></div><img src="images/logo.png" alt="Logo"></div>
  <div class="splash-text">MarketList Loading...</div>
  <div class="splash-subtext">Get your groceries fast & safe!</div>
</div>

<!-- Header -->
<div class="headerbar">
  <div class="inner">
    <div class="brand"><img src="images/logo.png" alt="Logo"><div class="title">MarketList</div></div>
    <nav>
      <a href="#home">Home</a>
      <a href="#categories">Categories</a>
      <a href="#contact">Contact</a>
    </nav>
  </div>
</div>

<!-- Slider -->
<div class="slider-box">
  <div class="slider" id="mainSlider">
    <div class="slide active"><img src="images/IMG 1.jpg" alt="Market item 1"></div>
    <div class="slide"><img src="images/IMG 2.jpg" alt="Market item 2"></div>
    <div class="slide"><img src="images/IMG 3.jpg" alt="Market item 3"></div>
  </div>
  <div class="slider-nav" id="sliderNav"></div>
</div>

<!-- Main Content -->
<main class="container">
  <div class="card">
    <div class="header-main">
      <img src="images/logo.png" alt="Logo">
      <div>
        <h1>Send Your Market List</h1>
        <div class="slogan">Fast, Safe & Affordable</div>
      </div>
    </div>

    <form id="marketForm">
      <label for="name">Name</label>
      <input id="name" placeholder="Enter your name" required>

      <label for="phone">Phone Number</label>
      <input id="phone" placeholder="Enter your phone" required>

      <label for="delivery">Delivery Location</label>
      <div id="locationContainer">
        <input id="location" placeholder="Delivery location will appear here" readonly>
        <button type="button" id="detectLocationBtn">Detect Your Location</button>
      </div>

      <div id="deliveryInfo">Distance & Delivery Fee will appear here.</div>

      <label for="market">Select Market</label>
      <select id="market" required>
        <option value="">-- Select Market --</option>
        <option>Makola Market</option>
        <option>Nima Market</option>
        <option>Accra Mall</option>
        <option>Marina Mall</option>
        <option>Lapaz Market</option>
        <option>Accra Market</option>
        <option>Kasoa Market</option>
      </select>

      <label for="category">Select Category</label>
      <select id="category" required>
        <option value="">-- Select Category --</option>
        <option>Groceries / Food Stuffs</option>
        <option>Home Appliances</option>
        <option>Electrical Appliances</option>
        <option>Clothes</option>
      </select>

      <label for="items">Items</label>
      <textarea id="items" placeholder="List your items" required></textarea>

      <label for="budget">Enter Budget (₵)</label>
      <input id="budget" type="number" placeholder="Enter your budget" min="0">

      <div class="transparent-box">
        <p>Service Fee (20%): ₵<span id="serviceFee">0.00</span></p>
        <p>Total (Budget + Service Fee): ₵<span id="grandTotal">0.00</span></p>
        <p>⚠️ Customers are responsible for delivery fees.<br>
        Make payment to:<br>0537351866<br>Account Name: Michael Awintini Akurugu<br>Reference: (Customer Name)</p>
      </div>

      <a href="#" class="send-whatsapp" id="sendBtn">Send List via WhatsApp</a>
    </form>
  </div>
</main>

<!-- Map Popup -->
<div id="mapPopup">
  <div id="mapContainer">
    <button id="closePopup">X</button>
    <div id="map"><div id="userMarker"></div></div>
    <div id="popupButtons">
      <button id="setLocationBtn">Detect My Location</button>
      <button id="saveLocationBtn">Save Location</button>
    </div>
  </div>
</div>

<!-- Chatbot -->
<div class="chatbot-btn" id="chatToggle">💬</div>
<div class="chat-overlay" id="chatOverlay">
  <div class="chat-header">MarketList Assistant</div>
  <div class="chat-body" id="chatBody">
    <div class="bot-msg">Hello! How can I help you today?</div>
  </div>
</div>

<footer class="footer">© 2025 MarketList. All rights reserved.</footer>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// Preloader
setTimeout(()=>{ document.getElementById('preloader').classList.add('hidden'); }, 5000);

// Slider
const slides = document.querySelectorAll('.slide');
const dotsContainer = document.getElementById('sliderNav');
let currentIndex = 0;
slides.forEach((s,i)=>{ 
  const dot = document.createElement('div'); dot.classList.add('slider-dot'); if(i===0) dot.classList.add('active');
  dot.addEventListener('click', ()=>{ goToSlide(i); }); 
  dotsContainer.appendChild(dot);
});
function goToSlide(i){
  slides.forEach(s=>s.classList.remove('active')); slides[i].classList.add('active');
  document.querySelectorAll('.slider-dot').forEach(d=>d.classList.remove('active'));
  document.querySelectorAll('.slider-dot')[i].classList.add('active');
  currentIndex=i;
}

// Budget calculations
const budgetInput = document.getElementById('budget');
const serviceFeeEl = document.getElementById('serviceFee');
const grandTotalEl = document.getElementById('grandTotal');

budgetInput.addEventListener('input', ()=>{
  const budget = parseFloat(budgetInput.value) || 0;
  const serviceFee = budget * 0.2;
  serviceFeeEl.innerText = serviceFee.toFixed(2);
  grandTotalEl.innerText = (budget + serviceFee).toFixed(2);
});

// Detect location popup logic
const accraLat = 5.6037; const accraLng = -0.1870;
const neighborhoods = [
    {name: "Nima, Accra", x: 60, y: 30},
    {name: "Mamobi, Accra", x: 55, y: 35},
    {name: "Gutter, Accra", x: 50, y: 40},
    {name: "Alaska, Accra", x: 45, y: 45},
];
const mapPopup = document.getElementById('mapPopup');
const openMapBtn = document.getElementById('detectLocationBtn');
const closePopup = document.getElementById('closePopup');
const setLocationBtn = document.getElementById('setLocationBtn');
const saveLocationBtn = document.getElementById('saveLocationBtn');
const locationInput = document.getElementById('location');
const deliveryInfo = document.getElementById('deliveryInfo');
const markerEl = document.getElementById('userMarker');
let userMarker;

const map = L.map('map').setView([accraLat, accraLng], 13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{ maxZoom:19, attribution:'&copy; OpenStreetMap contributors' }).addTo(map);

openMapBtn.addEventListener('click', ()=>{ mapPopup.style.display='flex'; map.invalidateSize(); });
closePopup.addEventListener('click', ()=>{ mapPopup.style.display='none'; });

setLocationBtn.addEventListener('click', ()=>{
    if(!navigator.geolocation){ alert("Geolocation not supported."); return; }
    setLocationBtn.disabled=true; setLocationBtn.innerText="Detecting...";
    navigator.geolocation.getCurrentPosition(pos=>{
        const { latitude, longitude } = pos.coords;
        let nearest = neighborhoods[0];
        if(latitude > 5.6) nearest = neighborhoods[1];
        else if(latitude < 5.59) nearest = neighborhoods[2];
        else nearest = neighborhoods[3];

        locationInput.value = nearest.name;
        markerEl.style.left = nearest.x + '%';
        markerEl.style.top = nearest.y + '%';
        markerEl.style.display = 'block';

        if(userMarker) userMarker.remove();
        userMarker = L.marker([latitude, longitude]).addTo(map).bindPopup("Your Location").openPopup();
        map.setView([latitude, longitude], 14);

        const R = 6371;
        const dLat = (latitude - accraLat)*Math.PI/180;
        const dLon = (longitude - accraLng)*Math.PI/180;
        const a = Math.sin(dLat/2)**2 + Math.cos(accraLat*Math.PI/180)*Math.cos(latitude*Math.PI/180)*Math.sin(dLon/2)**2;
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        const distance = R * c;
        let fee = distance <= 20 ? 20 : 20 + (Math.ceil(distance)-20)*2;
        const estTime = Math.ceil(distance)*2;
        deliveryInfo.innerText = `Distance: ${distance.toFixed(1)} km | Delivery Fee: GHS ${fee} | Est. Time: ${estTime} min`;

        setLocationBtn.disabled=false; setLocationBtn.innerText="Detect My Location";
    }, err=>{ alert("Failed to detect location: "+err.message); setLocationBtn.disabled=false; setLocationBtn.innerText="Detect My Location"; });
});

saveLocationBtn.addEventListener('click', ()=>{
    alert("Location saved: "+locationInput.value);
    mapPopup.style.display='none';
});

// WhatsApp validation
const sendBtn = document.getElementById('sendBtn');
sendBtn.addEventListener('click', (e)=>{
  e.preventDefault();
  const name = document.getElementById('name').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const location = document.getElementById('location').value.trim();
  const market = document.getElementById('market').value;
  const category = document.getElementById('category').value;
  const items = document.getElementById('items').value.trim();
  const budget = document.getElementById('budget').value;
  if(!name || !phone || !location || !market || !category || !items){ alert("Please fill in all fields!"); return; }
  const message = `Name: ${name}%0APhone: ${phone}%0ALocation: ${location}%0AMarket: ${market}%0ACategory: ${category}%0AItems: ${items}%0ABudget: ${budget}`;
  window.open(`https://wa.me/?text=${message}`, '_blank');
});

// Chatbot toggle
const chatBtn = document.getElementById('chatToggle');
const chatOverlay = document.getElementById('chatOverlay');
chatBtn.addEventListener('click', ()=>{ chatOverlay.style.display = chatOverlay.style.display==='flex' ? 'none' : 'flex'; });
</script>
</body>
</html>
